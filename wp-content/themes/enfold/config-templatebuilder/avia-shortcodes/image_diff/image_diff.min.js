"use strict";var avia_js_shortcodes=avia_js_shortcodes||{};!function(){if(!avia_js_shortcodes.aviaImageDiff){class scAviaImageDiff{container=null;id="";divider="vertical";handle=null;settings={};wrapperDiv=[];btnOverlay=[];btnBefore=[];btnAfter=[];imgBefore=[];imgAfter=[];imgDimension={};mouseCapture=!1;touchCapture=!1;downScreenX=0;downScreenY=0;downHandlePos=0;preview=!1;constructor(t){this.container=t,this.container.scAviaImageDiff=this,this.id=t.getAttribute("id"),this.handle=t.getElementsByClassName("av-image-diff-handle"),this.handle.length&&(this.handle=this.handle[0],this.init())}init(){this.settings=JSON.parse(this.container.dataset.image_diff),this.wrapperDiv=this.container.getElementsByClassName("av-image-diff-wrapper"),this.btnOverlay=this.container.getElementsByClassName("av-image-diff-overlay"),this.btnBefore=this.btnOverlay[0].getElementsByClassName("label-before"),this.btnAfter=this.btnOverlay[0].getElementsByClassName("label-after"),this.imgBefore=this.container.getElementsByClassName("av-img-before"),this.imgAfter=this.container.getElementsByClassName("av-img-after"),this.imgBefore.length&&this.imgAfter.length?(this.container.classList.contains("av-handle-horizontal")&&(this.divider="horizontal"),this.preview=null!=document.getElementById("av-admin-preview"),this.bindEvents(),this.initialPositionHandler()):this.hideHandlerDOM()}hideHandlerDOM(){this.handle.style.display="none",this.btnOverlay.length&&(this.btnOverlay[0].style.display="none")}initialPositionHandler(){let t=void 0===this.settings.drag_start?50:parseInt(this.settings.drag_start);isNaN(t)&&(t=50);let i=0;this.imgDimension=this.imgBefore[0].getBoundingClientRect(),i="horizontal"==this.divider?this.imgDimension.height*(t/100):this.imgDimension.width*(t/100),this.container.classList.add("av-initialise"),this.adjustDividerFrame(i);let e=this;setTimeout((function(){e.container.classList.remove("av-initialise")}),700)}adjustDividerFrame(t){if(this.container.classList.remove("av-handler-at-before","av-handler-at-after"),(t=Math.round(t))<=0&&(t=0,this.container.classList.add("av-handler-at-before")),"horizontal"==this.divider){t>=this.imgDimension.height+5&&(t=Math.round(this.imgDimension.height+5),this.container.classList.add("av-handler-at-after"));let i=this.imgDimension.height-t;this.handle.style.top=t+"px",this.imgBefore[0].style["clip-path"]="inset( 0 0 "+i+"px 0 )",this.imgAfter[0].style["clip-path"]="inset( "+t+"px 0 0 0 )"}else{t>=this.imgDimension.width+5&&(t=Math.round(this.imgDimension.width+5),this.container.classList.add("av-handler-at-after"));let i=this.imgDimension.width-t;this.handle.style.left=t+"px",this.imgBefore[0].style["clip-path"]="inset( 0 "+i+"px 0 0 )",this.imgAfter[0].style["clip-path"]="inset( 0 0 0 "+t+"px )"}}bindEvents(){this.container.onavia_start_animation=t=>{const i=new CustomEvent("avia_start_animation",{bubbles:!0,cancelable:!0});this.container.dispatchEvent(i)},this.container.addEventListener("avia_start_animation",this.onAviaStartAnimation.bind(this)),this.handle.addEventListener("click",this.onHandleClick.bind(this)),this.handle.addEventListener("mousedown",this.onMouseDown.bind(this)),this.wrapperDiv.length>0&&(this.wrapperDiv[0].addEventListener("click",this.onClickWrapper.bind(this)),this.wrapperDiv[0].addEventListener("touchstart",this.onTouchStart.bind(this))),this.btnBefore.length>0&&this.btnBefore[0].addEventListener("click",this.onClickBtnBefore.bind(this)),this.btnAfter.length>0&&this.btnAfter[0].addEventListener("click",this.onClickBtnAfter.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this)),window.addEventListener("touchmove",this.onTouchMove.bind(this)),window.addEventListener("touchend",this.onTouchEnd.bind(this)),this.preview?(window.addEventListener("resize",this.onResize.bind(this)),this.container.addEventListener("animationend",this.onAnimationEnd.bind(this))):window.addEventListener("resize",_.debounce(this.onResize.bind(this),200))}onAviaStartAnimation(t){this.container.classList.contains("avia_animation_finished")||(this.preview&&this.container.classList.add("avia_start_animation","avia_animation_finished"),void 0!==t&&this.container.classList.add("avia_animation_finished","avia_start_delayed_animation"))}onAnimationEnd(t){this.preview&&this.initialPositionHandler()}onMouseDown(t){this.touchCapture||(t.preventDefault(),t.stopPropagation(),this.mouseCapture=!0,this.container.classList.add("av-active-drag"),this.downScreenX=t.screenX,this.downScreenY=t.screenY,"horizontal"==this.divider?this.downHandlePos=this.handle.style.top:this.downHandlePos=this.handle.style.left,this.downHandlePos=parseInt(this.downHandlePos.replace("px","")))}onMouseMove(t){if(!this.mouseCapture)return;t.preventDefault(),t.stopPropagation();let i=0,e=0;e="horizontal"==this.divider?t.screenY-this.downScreenY:t.screenX-this.downScreenX,Math.abs(e)<5||(i=this.downHandlePos+e,this.adjustDividerFrame(i))}onMouseUp(t){this.mouseCapture&&(t.preventDefault(),t.stopPropagation(),this.mouseCapture=!1,this.container.classList.remove("av-active-drag"))}onTouchStart(t){this.mouseCapture||t.touches.length&&(t.explicitOriginalTarget&&t.explicitOriginalTarget.classList.contains("av-img-diff-label")&&!this.container.classList.contains("btn-on-hover")?t.explicitOriginalTarget.dispatchEvent(new MouseEvent("click")):(t.preventDefault(),t.stopPropagation(),this.touchCapture=!0,this.container.classList.add("av-active-drag"),this.downScreenX=t.touches[0].screenX,this.downScreenY=t.touches[0].screenY,"horizontal"==this.divider?this.downHandlePos=this.handle.style.top:this.downHandlePos=this.handle.style.left,this.downHandlePos=parseInt(this.downHandlePos.replace("px",""))))}onTouchMove(t){if(!this.touchCapture)return;t.preventDefault(),t.stopPropagation();let i=0,e=0;e="horizontal"==this.divider?t.touches[0].screenY-this.downScreenY:t.touches[0].screenX-this.downScreenX,Math.abs(e)<5||(i=this.downHandlePos+e,this.adjustDividerFrame(i))}onTouchEnd(t){this.touchCapture&&(t.preventDefault(),t.stopPropagation(),this.touchCapture=!1,this.container.classList.remove("av-active-drag"))}onResize(t){let i=0,e=0;"horizontal"==this.divider?(i=this.handle.style.top,e=this.imgDimension.height):(i=this.handle.style.left,e=this.imgDimension.width),i=parseInt(i.replace("px","")),i<0?e=0:0!=e&&(e=Math.round(i/e*100)),e>100&&(e=100),this.settings.drag_start=e,this.imgBefore[0].style["clip-path"]="inset( 0 0 0 0 )",this.imgAfter[0].style["clip-path"]="inset( 0 0 0 0 )",this.initialPositionHandler()}onHandleClick(t){t.preventDefault(),t.stopPropagation()}onClickBtnBefore(t){t.preventDefault(),t.stopPropagation(),this.adjustDividerFrame(0)}onClickBtnAfter(t){t.preventDefault(),t.stopPropagation();let i=0;i="horizontal"==this.divider?this.imgDimension.height:this.imgDimension.width,this.adjustDividerFrame(i+15)}onClickWrapper(t){t.preventDefault(),t.stopPropagation();let i=0;i="horizontal"==this.divider?t.layerY:t.layerX,this.adjustDividerFrame(i)}}avia_js_shortcodes.aviaImageDiff=function(t){return new scAviaImageDiff(t)}}const t=function(){if("complete"!==document.readyState)return;let t=document.getElementsByClassName("avia-image-diff-container");for(let i of t)avia_js_shortcodes.aviaImageDiff(i)};"complete"===document.readyState?t():document.addEventListener("readystatechange",t)}();